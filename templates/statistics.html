{% extends "base.html" %}

{% block content %}

<div class="row">
    {% if code == 0 %}
    <h2 class="header col-12">{{title}}</h2>
    {% for result in results %}
    <div class="col-md-6">
        <div class="item">
            <div class="row result-header">
                <div class="col-12 text-wrap">
                    <h4>
                        {{result.test.name}} #{{result.id}}
                        {% if current_user.type_id == 3 %}
                        <button type="button" class="close">
                            <a href="/delete_result/{{result.id}}" title="Удалить" class="close-btn text-danger">&times;</a>
                        </button>
                        {% elif result.is_deleted %}
                        <a class="text-danger" onclick="alert('Пользователь удалил этот результат из списка')" title="Пользователь удалил этот результат из списка"><i class="fas fa-trash-alt"></i></a>
                        {% endif %}
                    </h4>
                    <hr>
                </div>
                <div class="col-9">
                    <h6>{{result.user.nickname}}</h6>
                </div>
                <div class="col-3">
                    <h6>{{result.finish_date}}</h6>
                </div>
            </div>
            {% for row in result.rows %}
            <div class="row result-row align-items-center">
                <div class="col result-cell text-wrap">
                    {{row.text}}
                </div>
                <div class="col result-cell text-wrap
                    {% if row.answer == row.correct %} correct
                    {% else %} incorrect
                    {% endif %}">
                    {% if row.answer != None %}{{row.answer}}{% else %} <b>-</b> {% endif %}
                </div>
                <div class="col result-cell text-wrap correct">
                    {{row.correct}}
                </div>
            </div>
            {% endfor %}
            <div class="row result">
                <div class="col-9 result-cell">Итого</div>
                <div class="col-3 result-cell
                    {% if result.n_correct_answers == result.n_all_answers%} correct {% endif %}
                ">
                    {{result.n_correct_answers}}/{{result.n_all_answers}}
                    <small>{{(result.n_correct_answers / result.n_all_answers * 100)|round}}%</small>
                </div>
            </div>
        </div>
    </div>
    {% endfor %}
    {% elif code == 1 %}
    <h2 class="header col-12">{{title}}</h2>
    <div class="alert alert-primary col-10 m-4">
        <h2>Пройденных тестов пока нет.</h2>
    </div>
    {% elif code == 2 %}
    {% include "go_away.html" %}
    {% elif code == 3 %}
    <div class="alert alert-danger col-10 m-4">
        <h2>Такого пользователя нет</h2>
    </div>
    {% endif %}
</div>

{% endblock %}